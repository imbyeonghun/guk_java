<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>게시글 등록</title>
	<script src="../../static/jquery.js"></script>
	<style>
		.container{
			max-width: 500px;
			margin: 0 auto; 
		}
		.input-box{
			margin-top: 10px;
		}
		.input-box>.label{
			display: block;
		}
		.input-box>.input{
			width: 100%; height: 30px; display: block;
			margin-top: 5px; padding-left: 10px; border-radius: 5px;
			box-sizing: border-box; border: 1px solid black;
		}
		.input-box>.text-area{
			height: 200px;
		}
		.btn{
			width: 100%; box-sizing: border-box; background-color: white;
			border: 1px solid green; border-radius: 5px; margin-top: 10px;
			height: 30px; line-height: 28px; display: block; cursor: pointer;
		}
		.table{
			width: 100%; border-collapse: collapse; 
		}
		.table tr{
			border: 1px solid gray; border-width: 1px 0; height: 30px;
		}
		.table.table-hover>tbody>tr:hover{
			background-color: aquamarine;
		}
	</style>
</head>
<body>
	<form action="" class="container">
		<h1>게시글 등록</h1>
		<div class="input-box">
			<label for="title" class="label">제목:</label>
			<input type="text" name="title" id="title" class="input" placeholder="제목을 입력하세요.">
		</div>
		<div class="input-box">
			<label for="writer" class="label">작성자:</label>
			<input type="text" name="writer" id="writer" class="input" placeholder="작성자를 입력하세요.">
		</div>
		<div class="input-box">
			<label for="title" class="label">내용:</label>
			<textarea name="content" id="content" rows="10" class="input text-area" placeholder="내용을 입력하세요."></textarea>
		</div>
		<button class="btn">등록</button>
	</form>
	<hr>
	<div class="container">
		<h1>게시글 리스트</h1>
		<table class="table table-hover">
			<thead>
				<tr>
					<th>번호</th>
					<th>제목</th>
					<th>작성자</th>
					<th>조회수</th>
				</tr>
			</thead>
			<tbody class="tbody">
				
			</tbody>
		</table>
	</div>

	<script>
		// 게시글 리스트를 관리할 배열
		let list = [];
		display(list);
		
		// 버튼을 선택
		let btn = document.querySelector(".btn");

		// 버튼에 클릭 이벤트 등록
		btn.onclick = function(){
			// 입력한 제목,내용,작성자 가져옴
			let title = document.getElementById("title").value;
			let writer = document.getElementById("writer").value;
			let content = document.getElementById("content").value;

			let num;
			// 가져온 제목,내용,작성자와 번호(계산),조회수(0)를 이용해서 객체를 생성
			if(!list.length){
				num = 1;
			}else{
				num = parseInt(list[0]["num"]) + 1;
			}
			let obj = {
				num,
				title,
				content,
				writer,
				view : 0
			};
			if(!checkBoard(obj)){
				alert("모든 항목은 필수 항목입니다.");
				return false;
			}
			// 생성된 객체를 배열에 앞에 추가
			list.unshift(obj);
			// display함수를 호출 : 테이블에 list를 출력하는 함수
			display(list);
			// 입력 값들을 비워줌
			initForm();
			// return false를 통해 서버로 전송되는 것을 막아줌
			return false;
		};

		// a태그 클릭했을 때 
		function linkClick(){
			alert("1")
		}

		// display함수
		function display(list){
			// tbody에 있는 tr태그들을 제거
			let tbody = document.querySelector("tbody");
			tbody.innerHTML = "";
			// list가 비어있으면 
			if(!list.length){
				// tr태그 생성
				let tr = createElement("tr");
				// th태그 생성. 등록된 게시글이 없습니다.colspan=4
				let th = createElement("th","등록된 게시글이 없습니다.",{colspan : 4});
				// tr태그에 th태그를 추가
				tr.append(th);
				// tbody태그에 tr태그 추가
				tbody.append(tr);
				// return
				return;
			}

			// 반복문 : list 전체
			for(let i = 0; i <list.length; i++){
				// tr태그 생성
				let tr = createElement("tr");
				// 반복문 : list[i] 객체를 for in
				for(let key in list[i]){
					if(key == "content"){
						continue;
					}
					let obj = list[i];
					if(key != "title"){
						// td태그 생성
						let td = createElement("td", String(obj[key]), {class : key});
						// tr태그에 추가
						tr.append(td);
					}else{
						// td태그 생성
						let td = createElement("td", null, {class : key});
						// a태그 생성
						let a = createElement("a", String(obj[key]), {class : "link", href : "#"});
						a.onclick = linkClick;
						// td태그에 a태그 추가
						td.append(a);
						// tr태그에 추가
						tr.append(td);
					}
				}
				// tbody태그에 tr태그를 추가
				tbody.append(tr);
			}
		}

		// 태그, 태그에 들어갈 문자열,속성을 주면 해당 값들을 가지는 태그 생성하는 함수
		function createElement(tagName, text, attributes){
			let element = document.createElement(tagName);
			if(text){
				let textNode = document.createTextNode(text);
				element.append(textNode);
			}
			if(attributes){
				for(key in attributes){
					let attrNode = document.createAttribute(key);
					attrNode.value = attributes[key];
					element.setAttributeNode(attrNode);
				}
			}
			return element;
		}

		// 게시글에 빈 항목이 있는지 없는지 알려주는 함수
		function checkBoard(board){
			if(!board){
				return false;
			}
			if(typeof board != "object"){
				return false;
			}
			// 제목 체크
			if(!board["title"].trim().length){
				return false;
			}
			// 작성자 체크
			if(!board["writer"].trim().length){
				return false;
			}
			// 내용 체크
			if(!board["content"].trim().length){
				return false;
			}
			return true;
		}

		// form태그의 입력값들을 초기화하는 함수
		function initForm(){
			let title = document.getElementById("title").value = "";
			let writer = document.getElementById("writer").value = "";
			let content = document.getElementById("content").value = "";	
		}

		/*
		// jquery
		// 번호 생성
		let count = 1;
		let views = 0;
		
		// 값들을 가지고 리스트 생성
		$(".btn").click(function(){
			// 제목,작성자에 입력받은 값을 선택
			let title = $("#title").val();
			let writer = $("#writer").val();

			$(".tbody").prepend(
				`<tr>
					<th>${count++}</th>
					<th>${title}</th>
					<th>${writer}</th>
					<th>${views}</th>
				</tr>`
				)
			$(".noneList").hide();
			return false;
		});
		*/
	</script>
</body>
</html>